<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Elara"/><meta name="copyright" content="Elara"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="å­¦ä¹ è®°å½•"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="è‡ªå­¦Langchain4j | Elaraçš„å°çª"/><meta name="apple-mobile-web-app-title" content="è‡ªå­¦Langchain4j | Elaraçš„å°çª"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/10/23/è‡ªå­¦Langchain4j/"/><meta name="description" content="Langchain4j ç®€æ˜“æ•™ç¨‹1.Langchain4jçš„ä»‹ç»  ä¸»æµçš„è°ƒç”¨å¤§æ¨¡å‹çš„å·¥å…·åº“æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯ Langchain4jï¼ŒäºŒæ˜¯SpringAIã€‚ç®€å•æ¥è¯´Langchain4jæ˜¯javaè°ƒç”¨å¤§æ¨¡å‹çš„å·¥å…·åº“ï¼Œä½¿å¤§æ¨¡å‹å’Œä¼ ç»Ÿçš„è½¯ä»¶æ·±åº¦èåˆã€‚ä»Šå¤©å­¦ä¹ ç®€å•çš„ Langchain4jçš„åº”ç”¨ã€‚  2.å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ Langchain4j åˆ›å»ºSpringBooté¡¹ç›® å¼•å…¥ La...">
<meta property="og:type" content="article">
<meta property="og:title" content="è‡ªå­¦Langchain4j | Elaraçš„å°çª">
<meta property="og:url" content="http://example.com/2025/10/23/%E8%87%AA%E5%AD%A6Langchain4j/index.html">
<meta property="og:site_name" content="Elaraçš„å°çª">
<meta property="og:description" content="Langchain4j ç®€æ˜“æ•™ç¨‹1.Langchain4jçš„ä»‹ç»  ä¸»æµçš„è°ƒç”¨å¤§æ¨¡å‹çš„å·¥å…·åº“æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯ Langchain4jï¼ŒäºŒæ˜¯SpringAIã€‚ç®€å•æ¥è¯´Langchain4jæ˜¯javaè°ƒç”¨å¤§æ¨¡å‹çš„å·¥å…·åº“ï¼Œä½¿å¤§æ¨¡å‹å’Œä¼ ç»Ÿçš„è½¯ä»¶æ·±åº¦èåˆã€‚ä»Šå¤©å­¦ä¹ ç®€å•çš„ Langchain4jçš„åº”ç”¨ã€‚  2.å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ Langchain4j åˆ›å»ºSpringBooté¡¹ç›® å¼•å…¥ La...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/lang.png">
<meta property="article:published_time" content="2025-10-23T10:45:48.000Z">
<meta property="article:modified_time" content="2025-10-30T15:28:44.096Z">
<meta property="article:author" content="Elara">
<meta property="article:tag" content="å­¦ä¹ è®°å½•">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/images/lang.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>è‡ªå­¦Langchain4j | Elaraçš„å°çª</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 8.0.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="ä¸»é¡µ"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="ä¸»é¡µ"><div>Elaraçš„å°çª</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"></div><div id="nav-function"><div id="search-btn"><a href="javascript:void(0);" title="æœç´¢" accesskey="s"><img src="/assets/images/svg/uc/uc-search.svg" class="icon noview" alt="Icon"><span>æœç´¢</span></a></div><div id="menu-btn"><a href="javascript:void(0);" title="æ‰“å¼€èœå•"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="ä¸»é¡µ"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="ä¸»é¡µ">Elaraçš„å°çª</a></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">ã€Œ MEOW ã€</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">è‡ªå­¦Langchain4j</h1><div class="post-author"><span>ä½œè€…: Elara</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>å‘è¡¨äº2025-10-23</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>æ›´æ–°äº2025-10-30</span></div></div><div class="post-read"></div></div><div class="post-attribute"><div class="post-tags"><img src="/assets/images/svg/ta/ta-tag.svg" class="icon noview" alt="Icon"><span><a class="post-tags-link" href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="tag">å­¦ä¹ è®°å½•</a></span></div></div></div><div class="post markdown" indent="false"><h1 id="Langchain4j-ç®€æ˜“æ•™ç¨‹"><a href="#Langchain4j-ç®€æ˜“æ•™ç¨‹" class="headerlink" title="Langchain4j ç®€æ˜“æ•™ç¨‹"></a>Langchain4j ç®€æ˜“æ•™ç¨‹</h1><h2 id="1-Langchain4jçš„ä»‹ç»"><a href="#1-Langchain4jçš„ä»‹ç»" class="headerlink" title="1.Langchain4jçš„ä»‹ç»"></a>1.Langchain4jçš„ä»‹ç»</h2><p>  ä¸»æµçš„è°ƒç”¨å¤§æ¨¡å‹çš„å·¥å…·åº“æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯ Langchain4jï¼ŒäºŒæ˜¯SpringAIã€‚ç®€å•æ¥è¯´Langchain4jæ˜¯javaè°ƒç”¨å¤§æ¨¡å‹çš„å·¥å…·åº“ï¼Œä½¿å¤§æ¨¡å‹å’Œä¼ ç»Ÿçš„è½¯ä»¶æ·±åº¦èåˆã€‚ä»Šå¤©å­¦ä¹ ç®€å•çš„ Langchain4jçš„åº”ç”¨ã€‚</p>
<hr>
<h2 id="2-å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ-Langchain4j"><a href="#2-å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ-Langchain4j" class="headerlink" title="2.å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ Langchain4j"></a>2.å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ Langchain4j</h2><ol>
<li>åˆ›å»ºSpringBooté¡¹ç›®</li>
<li>å¼•å…¥ Langchain4jèµ·æ­¥ä¾èµ–</li>
<li>åœ¨application.ymlé…ç½®å¤§æ¨¡å‹ä¿¡æ¯ï¼Œä¾¿äºè°ƒç”¨</li>
<li>ç¼–å†™controllerå±‚ï¼Œè°ƒç”¨å¤§æ¨¡å‹</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class ChatController &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private OpenAiChatModel model; </span><br><span class="line">    @RequestMapping(&quot;/chat&quot;)</span><br><span class="line">    public String chat(String message)&#123;</span><br><span class="line">        String result = model.chat(message);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<hr>
<h2 id="3-AIService-å·¥å…·ç±»"><a href="#3-AIService-å·¥å…·ç±»" class="headerlink" title="3.AIService å·¥å…·ç±»"></a>3.AIService å·¥å…·ç±»</h2><p>  AIServiceå·¥å…·ç±»æ˜¯ç”¨äºè°ƒç”¨å¤§æ¨¡å‹çš„ï¼Œå‰é¢ä¾‹å­ç”¨äºè°ƒç”¨å¤§æ¨¡å‹çš„æ–¹å¼ä¸å¤ªå¸¸ç”¨ï¼Œå› ä¸ºæ¯”è¾ƒéº»çƒ¦ã€‚AIServiceæ•´åˆäº†å¾ˆå¤šé«˜çº§åŠŸèƒ½ï¼Œæ¯”å¦‚ä¼šè¯è®°å¿†ã€RAGçŸ¥è¯†åº“ç­‰ç­‰ï¼Œå¦‚æœè°ƒç”¨chatæ–¹æ³•ï¼Œè¿™äº›å·¥å…·éƒ½éœ€è¦è‡ªå·±ç¼–å†™ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚</p>
<hr>
<h3 id="AIServiceå·¥å…·ç±»ä½¿ç”¨æ–¹æ³•"><a href="#AIServiceå·¥å…·ç±»ä½¿ç”¨æ–¹æ³•" class="headerlink" title="AIServiceå·¥å…·ç±»ä½¿ç”¨æ–¹æ³•"></a>AIServiceå·¥å…·ç±»ä½¿ç”¨æ–¹æ³•</h3><ol>
<li>å¼•å…¥AIServiceä¾èµ–</li>
<li>å£°æ˜å°è£…èŠå¤©çš„æ¥å£   <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface ConsultantService &#123;</span><br><span class="line">//ç”¨äºèŠå¤©çš„æ–¹æ³•,messageä¸ºç”¨æˆ·è¾“å…¥çš„å†…å®¹</span><br><span class="line">public String chat(String message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div></li>
<li>åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//configé…ç½®ç±»</span><br><span class="line">@Configuration</span><br><span class="line">  public class CommonConfig &#123;</span><br><span class="line">  @Autowired</span><br><span class="line">  private OpenAiChatModel model;</span><br><span class="line">  @Bean         </span><br><span class="line">  public ConsultantService consultantService() &#123;</span><br><span class="line">      ConsultantService cs = AiServices.builder(ConsultantService.class)</span><br><span class="line">              .chatModel(model)//è®¾ç½®å¯¹è¯æ—¶ä½¿ç”¨çš„æ¨¡å‹å¯¹è±¡</span><br><span class="line">              .build();</span><br><span class="line">      return cs;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div></li>
<li>ç¼–å†™controllerå±‚å¹¶æ³¨å…¥serviceå±‚ä½¿ç”¨   <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class ChatController &#123;</span><br><span class="line">@Autowired</span><br><span class="line">private ConsultantService consultantService;</span><br><span class="line">@RequestMapping(&quot;/chat&quot;)</span><br><span class="line">public String chat(String message)&#123;</span><br><span class="line">    String result = consultantService.chat(message);</span><br><span class="line">    return result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div></li>
</ol>
<hr>
<h3 id="AIServiceå·¥å…·ç±»å£°æ˜ä½¿ç”¨"><a href="#AIServiceå·¥å…·ç±»å£°æ˜ä½¿ç”¨" class="headerlink" title="AIServiceå·¥å…·ç±»å£°æ˜ä½¿ç”¨"></a>AIServiceå·¥å…·ç±»å£°æ˜ä½¿ç”¨</h3><p>  ä¸ºäº†ç®€åŒ– AIServiceç±»çš„ä½¿ç”¨ï¼Œ Langchain4jæä¾›äº†å£°æ˜å¼ä½¿ç”¨çš„æ–¹æ³•ï¼Œä½¿ç”¨æ³¨è§£ï¼Œ Langchain4jä¼šè‡ªåŠ¨åˆ›å»ºä»£ç†å¯¹è±¡æ³¨å…¥åˆ°å®¹å™¨ã€‚<br>  ä¿®æ”¹åçš„serviceå±‚ï¼š<br>    <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@AiService (</span><br><span class="line">  wiringMode = AiServiceWiringMode.EXPLICIT,</span><br><span class="line">  chatModel = &quot;openAiChatModel&quot;</span><br><span class="line">)</span><br><span class="line">public interface ConsultantService &#123;</span><br><span class="line">  //ç”¨äºèŠå¤©çš„æ–¹æ³•,messageä¸ºç”¨æˆ·è¾“å…¥çš„å†…å®¹</span><br><span class="line">  public String chat(String message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div><br>  è§£é‡Šï¼š<br>    wiringModeï¼š<br>    ç”¨äºè£…é…æ¨¡å¼ï¼Œé»˜è®¤å–å€¼æ˜¯AiServiceWiringMode.AUTOMATICï¼Œæ˜¯è‡ªåŠ¨è£…é…ã€‚AiServiceWiringMode.EXPLICITæ˜¯æ‰‹åŠ¨è£…é…ã€‚<br>    chatModelï¼šæŒ‡å®šéœ€è¦ä½¿ç”¨çš„æ¨¡å‹å¯¹è±¡åï¼Œé¦–å­—æ¯å°å†™ã€‚<br>  ä½†è¿™ä¸¤ä¸ªå±æ€§ä¹Ÿå¯ä»¥ä¸æ‰‹åŠ¨è®¾ç½®ï¼Œç›´æ¥åŠ @AIService</p>
<h2 id="4-æµå¼è°ƒç”¨"><a href="#4-æµå¼è°ƒç”¨" class="headerlink" title="4. æµå¼è°ƒç”¨"></a>4. æµå¼è°ƒç”¨</h2><p>  è°ƒç”¨å¤§æ¨¡å‹æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€æ˜¯é˜»å¡è°ƒç”¨ï¼Œè€Œæ˜¯æµå¼è°ƒç”¨ã€‚åŒºåˆ«å°±æ˜¯æµå¼è°ƒç”¨æ˜¯å¤§æ¨¡å‹ç”Ÿæˆä¸€ç‚¹å†…å®¹å°±è¿”å›åˆ°å®¢æˆ·ç«¯ã€‚é˜»å¡å¼å°±æ˜¯ä¸€æ¬¡æ€§å“åº”ã€‚</p>
<p>  æµå¼è°ƒç”¨æ–¹å¼ï¼š</p>
<ol>
<li>å¼•å…¥ä¾èµ–</li>
<li>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®æµå¼æ¨¡å‹çš„ä¿¡æ¯</li>
<li>è°ƒæ•´ä¸Šè¿°serviceå±‚ä»£ç ï¼Œæµå¼è°ƒç”¨çš„è¿”å›å€¼ç±»å‹ä¸é˜»å¡å¼ä¸ä¸€æ ·ï¼Œæ˜¯Fluxç±»å‹ã€‚</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@AiService(</span><br><span class="line">      wiringMode = AiServiceWiringMode.EXPLICIT,</span><br><span class="line">      chatModel = &quot;openAiChatModel&quot;,</span><br><span class="line">      streamingChatModel = &quot;openAiStreamingChatModel&quot;</span><br><span class="line">)</span><br><span class="line">public interface ConsultantService &#123;</span><br><span class="line">  public Flux&lt;String&gt; chat(String message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<ol start="4">
<li>è°ƒæ•´controllerå±‚çš„ä»£ç ï¼Œè¦ä¿®æ”¹mappingè·¯å¾„çš„producesï¼Œé˜²æ­¢ä¹±ç ï¼Œç„¶åä¿®æ”¹è¿”å›ç±»å‹ã€‚</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class ChatController &#123;</span><br><span class="line">  @Autowired</span><br><span class="line">  private ConsultantService consultantService;</span><br><span class="line">  @RequestMapping(value = &quot;/chat&quot;,produces = &quot;text/html;charset=utf-8&quot;)</span><br><span class="line">  public Flux&lt;String&gt; chat(String memoryId,String message)&#123;</span><br><span class="line">      Flux&lt;String&gt; result = consultantService.chat(memoryId,message);</span><br><span class="line">      return result;</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<h2 id="5-æ¶ˆæ¯æ³¨è§£"><a href="#5-æ¶ˆæ¯æ³¨è§£" class="headerlink" title="5. æ¶ˆæ¯æ³¨è§£"></a>5. æ¶ˆæ¯æ³¨è§£</h2><p>  æ­¤æ³¨è§£ç”¨äºï¼Œå½“ç”¨æˆ·é—®ä¸€äº›ä¸è¯¥åŠŸèƒ½æ— å…³çš„æ—¶å€™ï¼Œéœ€è¦è®¾ç½®ç³»ç»Ÿä¿¡æ¯å›å¤ï¼Œè€Œä¸äºˆå›ç­”ã€‚æ¶ˆæ¯æ³¨è§£ç”¨äºè®¾å®šç³»ç»Ÿæ¶ˆæ¯ã€‚Langchain4jæä¾›äº†ä¸¤ç§æ¶ˆæ¯æ³¨è§£ï¼Œä¸€ä¸ªæ˜¯SystemMessage, å¦å¤–ä¸€ä¸ªæ˜¯UserMessageã€‚</p>
<ol>
<li>SystemMessageç”¨äºè®¾ç½®ç³»ç»Ÿæ¶ˆæ¯ï¼Œåœ¨serviceæ¥å£æ·»åŠ è¯¥æ³¨è§£<br>  <code>@SystemMessage(fromResource = &quot;system.txt&quot;)</code><br>  system.txtè¦å¯¼å…¥åˆ°resourcesæ–‡ä»¶å¤¹é‡Œï¼Œæ˜¯æå‰è®¾ç½®å¥½çš„ç³»ç»Ÿä¿¡æ¯å†…å®¹ã€‚</li>
<li>UserMessageå¯ä»¥å®ŒæˆåŒæ ·æ•ˆæœ<br>  <code>@UserMessage(&quot;è¿™æ˜¯ç³»ç»Ÿä¿¡æ¯ã€‚&#123;&#123;it&#125;&#125;&quot;)</code><br>  é€šè¿‡<code>&#123;&#123;it&#125;&#125;</code>çš„æ–¹å¼åŠ¨æ€è·å–åˆ°ç”¨æˆ·ä¼ é€’çš„ä¿¡æ¯ï¼Œå‰é¢æ˜¯é¢„è®¾çš„å†…å®¹ã€‚</li>
</ol>
<h2 id="6-ä¼šè¯è®°å¿†"><a href="#6-ä¼šè¯è®°å¿†" class="headerlink" title="6. ä¼šè¯è®°å¿†"></a>6. ä¼šè¯è®°å¿†</h2><p>  ç”±äºå¤§æ¨¡å‹æœ¬èº«ä¸ä¼šæœ‰è®°å¿†ï¼Œéœ€è¦å°†ä¸Šæ–‡å¯¹è¯å†…å®¹ä¸€èµ·å‘é€ç»™å¤§æ¨¡å‹ï¼Œæ‰èƒ½ä¿è¯è¿è´¯çš„å¯¹è¯å’Œå‡†ç¡®çš„å›ç­”ã€‚æˆ‘ä»¬éœ€è¦å®ç°ä¼šè¯è®°å¿†ã€‚<br>  Langchain4jæä¾›äº†ä¸€ä¸ªChatMemoryæ¥å£å¯ä»¥ç”¨äºæ·»åŠ è®°å½•ã€‚TokenWindowChatMemoryå’ŒMessageWindowChatMemoryæ˜¯è¯¥æ¥å£çš„ä¸¤ä¸ªå®ç°ç±»ã€‚</p>
<hr>
<h3 id="è°ƒç”¨æ–¹æ³•ï¼š"><a href="#è°ƒç”¨æ–¹æ³•ï¼š" class="headerlink" title="è°ƒç”¨æ–¹æ³•ï¼š"></a>è°ƒç”¨æ–¹æ³•ï¼š</h3><ol>
<li>å®ç°æ¥å£</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface ChatMemory &#123;</span><br><span class="line">  Object id();//è®°å¿†å­˜å‚¨å¯¹è±¡çš„å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºè®°å¿†éš”ç¦»</span><br><span class="line">  void add(ChatMessage var1);//æ·»åŠ ä¸€æ¡ä¼šè¯è®°å¿†</span><br><span class="line">  List&lt;ChatMessage&gt; messages();//è·å–æ‰€æœ‰ä¼šè¯è®°å¿†</span><br><span class="line">  void clear();//æ¸…é™¤æ‰€æœ‰ä¼šè¯è®°å¿†</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<ol start="2">
<li>åœ¨é…ç½®ç±»å®šä¹‰ä¼šè¯è®°å¿†å¯¹è±¡</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public ChatMemory chatMemory() &#123;</span><br><span class="line">  return MessageWindowChatMemory.builder()</span><br><span class="line">          .maxMessages(20)//æœ€å¤§ä¿å­˜çš„ä¼šè¯è®°å½•æ•°é‡</span><br><span class="line">          .build();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<ol start="3">
<li>åœ¨serviceå±‚é…ç½®ä¼šè¯è®°å¿†å¯¹è±¡</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@AiService(</span><br><span class="line">      wiringMode = AiServiceWiringMode.EXPLICIT,</span><br><span class="line">      chatModel = &quot;openAiChatModel&quot;,</span><br><span class="line">      streamingChatModel = &quot;openAiStreamingChatModel&quot;,</span><br><span class="line">      chatMemory = &quot;chatMemory&quot;//é…ç½®ä¼šè¯è®°å¿†å¯¹è±¡</span><br><span class="line">  )</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<hr>
<h3 id="è®°å¿†éš”ç¦»"><a href="#è®°å¿†éš”ç¦»" class="headerlink" title="è®°å¿†éš”ç¦»"></a>è®°å¿†éš”ç¦»</h3><p>  è°ƒç”¨å¤§æ¨¡å‹çš„æ—¶å€™åŒæ—¶å¯èƒ½æœ‰å¾ˆå¤šç”¨æˆ·ï¼Œè¦ä¿è¯ä¸åŒç”¨æˆ·ä¹‹é—´çš„è®°å¿†è¦éš”ç¦»å¼€ï¼Œå­˜å…¥ä¸åŒçš„è®°å¿†å¯¹è±¡ä¸­ï¼Œåœ¨ä¸Šè¿°ä»£ç ä¸­æåˆ°çš„idæ–¹æ³•å°±æ˜¯ç”¨äºè®°å¿†éš”ç¦»ã€‚</p>
<p>  ä»¥ä¸‹ä¸ºå®ç°æ–¹æ³•ï¼š</p>
<ol>
<li>å®šä¹‰è®°å¿†å¯¹è±¡æä¾›è€…(è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„getæ–¹æ³•è·å–ä¸€ä¸ªæ–°çš„ChatMemoryå¯¹è±¡ä½¿ç”¨)</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public ChatMemoryProvider chatMemoryProvider() &#123;</span><br><span class="line">    ChatMemoryProvider chatMemoryProvider = new ChatMemoryProvider() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public ChatMemory get(Object memoryId) &#123;</span><br><span class="line">            return MessageWindowChatMemory.builder()</span><br><span class="line">                    .id(memoryId)//idå€¼</span><br><span class="line">                    .maxMessages(20)//æœ€å¤§ä¼šè¯è®°å½•æ•°é‡</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    return chatMemoryProvider;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<ol start="2">
<li>é…ç½®è®°å¿†å¯¹è±¡æä¾›è€…<br>  ä»…éœ€å°†ä¸Šè¿°æ”¹æˆ<code>chatMemoryProvider = &quot;chatMemoryProvider&quot;//é…ç½®è®°å¿†å¯¹è±¡æä¾›è€…</code></li>
<li>åœ¨serviceå±‚æ·»åŠ å‚æ•°memoryId</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface ConsultantService &#123;</span><br><span class="line">  @SystemMessage(fromResource = &quot;system.txt&quot;)</span><br><span class="line">  public Flux&lt;String&gt; chat(@MemoryId String memoryId, @UserMessage String message);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<ol start="4">
<li>åœ¨controllerå±‚æ·»åŠ ä¼ é€’çš„memoryId</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;/chat&quot;,produces = &quot;text/html;charset=utf-8&quot;)</span><br><span class="line">public Flux&lt;String&gt; chat(String memoryId,String message)&#123;</span><br><span class="line">  Flux&lt;String&gt; result = consultantService.chat(memoryId,message);</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<hr>
<h3 id="ä¼šè¯è®°å¿†æŒä¹…åŒ–"><a href="#ä¼šè¯è®°å¿†æŒä¹…åŒ–" class="headerlink" title="ä¼šè¯è®°å¿†æŒä¹…åŒ–"></a>ä¼šè¯è®°å¿†æŒä¹…åŒ–</h3><p>  ç”±äºMessageWindowChatMemoryçš„addæ–¹æ³•æ·»åŠ è®°å¿†æ—¶ï¼Œæ˜¯å­˜å‚¨åˆ°ChatMemoryStoreè¿™ä¸ªæ¥å£ï¼Œè¿™ä¸ªæ¥å£ç®€å•æ¥è¯´å°±æ˜¯æŠŠä¼šè¯è®°å½•å­˜å‚¨åˆ°å†…å­˜é‡Œï¼ŒæœåŠ¡å™¨é‡å¯åä¼šä¸¢å¤±ã€‚ä¼šè¯è®°å¿†æŒä¹…åŒ–å¯ä»¥å°†è®°å¿†å­˜å‚¨åˆ°å¤–éƒ¨æœåŠ¡å™¨å½“ä¸­ã€‚<br>  å°†ä¼šè¯è®°å¿†å­˜å‚¨åˆ°redisä¸­çš„æ­¥éª¤</p>
<ol>
<li>å¼•å…¥redisä¾èµ–</li>
<li>åœ¨é…ç½®æ–‡ä»¶é…ç½®redisè¿æ¥ä¿¡æ¯</li>
<li>å®šä¹‰å®ç°ChatMemoryæ¥å£ï¼Œé‡å†™getMessagesã€updateMessagesã€deleteMessagesæ–¹æ³•ï¼Œç”¨äºæ“ä½œredisï¼Œå¹¶ä¸”æŠŠå®ç°ç±»çš„å¯¹è±¡æ³¨å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚</li>
</ol>
  <div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">@Repository</span><br><span class="line">  public class RedisChatMemoryStore implements ChatMemoryStore &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private StringRedisTemplate redisTemplate;//æ³¨å…¥RedisTemplate</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;ChatMessage&gt; getMessages(Object memoryId) &#123;</span><br><span class="line">        //è·å–ä¼šè¯æ¶ˆæ¯</span><br><span class="line">        String json = redisTemplate.opsForValue().get(memoryId);</span><br><span class="line">        //æŠŠjsonå­—ç¬¦ä¸²è½¬åŒ–æˆList&lt;ChatMessage&gt;</span><br><span class="line">        List&lt;ChatMessage&gt; list = ChatMessageDeserializer.messagesFromJson(json);</span><br><span class="line">        return list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void updateMessages(Object memoryId, List&lt;ChatMessage&gt; list) &#123;</span><br><span class="line">        //æ›´æ–°ä¼šè¯æ¶ˆæ¯</span><br><span class="line">        //1.æŠŠlistè½¬æ¢æˆjsonæ•°æ®</span><br><span class="line">        String json = ChatMessageSerializer.messagesToJson(list);</span><br><span class="line">        //2.æŠŠjsonæ•°æ®å­˜å‚¨åˆ°redisä¸­</span><br><span class="line">        redisTemplate.opsForValue().set(memoryId.toString(),json, Duration.ofDays(1));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void deleteMessages(Object memoryId) &#123;</span><br><span class="line">        //åˆ é™¤ä¼šè¯æ¶ˆæ¯</span><br><span class="line">        redisTemplate.delete(memoryId.toString());</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>
<ol start="4">
<li>é…ç½®ChatMemoryStoreï¼Œä»…éœ€åœ¨é…ç½®ç±»æ”¹æˆ<code>.chatMemoryStore(redisChatMemoryStore)//é…ç½®ChatMemoryStore</code></li>
</ol>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ä¸Šè¿°å‡ ä¸ªå·¥å…·å·²ç»èƒ½åŸºæœ¬å®ç°è°ƒç”¨å¤§æ¨¡å‹çš„åŠŸèƒ½ï¼Œæ¶‰åŠåˆ°RAGçŸ¥è¯†åº“å’ŒToolsçš„ä¸€éƒ¨åˆ†åç»­ä¼šåŠ æ·±å­¦ä¹ ã€‚</p>
</div><div class="post-reward"><div class="post-reward-btn" title="èµèµä½œè€…"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">è‡´è°¢åå•</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">æœ¬ä½œå“ç”± Elara äº 2025-10-23 18:45:48 å‘å¸ƒ</div><div class="post-copyright-link"><span>ä½œå“åœ°å€ï¼š<a href="http://example.com/2025/10/23/%E8%87%AA%E5%AD%A6Langchain4j/">è‡ªå­¦Langchain4j</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/10/23/%E8%87%AA%E5%AD%A6Langchain4j/">å¤åˆ¶</button></div><div class="post-copyright-detail">é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œæœ¬ç«™ä½œå“å‡é‡‡ç”¨ <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href='/'>Elaraçš„å°çª</a></div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"><a class="post-tail-tags-link" href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="tag">å­¦ä¹ è®°å½•</a></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>ç›®å½•</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#Langchain4j-%E7%AE%80%E6%98%93%E6%95%99%E7%A8%8B"><span class="toc-list-text">Langchain4j ç®€æ˜“æ•™ç¨‹</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#1-Langchain4j%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-list-text">1.Langchain4jçš„ä»‹ç»</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#2-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8Spring%E6%95%B4%E5%90%88-Langchain4j"><span class="toc-list-text">2.å¿«é€Ÿå…¥é—¨â€”â€”ä½¿ç”¨Springæ•´åˆ Langchain4j</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#3-AIService-%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-list-text">3.AIService å·¥å…·ç±»</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#AIService%E5%B7%A5%E5%85%B7%E7%B1%BB%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-list-text">AIServiceå·¥å…·ç±»ä½¿ç”¨æ–¹æ³•</span></a></li><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#AIService%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%A3%B0%E6%98%8E%E4%BD%BF%E7%94%A8"><span class="toc-list-text">AIServiceå·¥å…·ç±»å£°æ˜ä½¿ç”¨</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#4-%E6%B5%81%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="toc-list-text">4. æµå¼è°ƒç”¨</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#5-%E6%B6%88%E6%81%AF%E6%B3%A8%E8%A7%A3"><span class="toc-list-text">5. æ¶ˆæ¯æ³¨è§£</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#6-%E4%BC%9A%E8%AF%9D%E8%AE%B0%E5%BF%86"><span class="toc-list-text">6. ä¼šè¯è®°å¿†</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#%E8%B0%83%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-list-text">è°ƒç”¨æ–¹æ³•ï¼š</span></a></li><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#%E8%AE%B0%E5%BF%86%E9%9A%94%E7%A6%BB"><span class="toc-list-text">è®°å¿†éš”ç¦»</span></a></li><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#%E4%BC%9A%E8%AF%9D%E8%AE%B0%E5%BF%86%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-list-text">ä¼šè¯è®°å¿†æŒä¹…åŒ–</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-list-text">å°ç»“</span></a></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="æ·±è‰²æ¨¡å¼" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="åˆ†äº«" type="button" data-text="http://example.com/2025/10/23/%E8%87%AA%E5%AD%A6Langchain4j/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="æ”¾å¤§å­—ä½“" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="ç¼©å°å­—ä½“" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="è®¾ç½®" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="ç›®å½•" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="è¿”å›é¡¶éƒ¨" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div><div class="search-overlay"><div class="search-container"><div class="search-header"><div class="search-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
æœç´¢</div><div class="search-close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z" /><path d="M9 8l6 8" /><path d="M15 8l-6 8" /></svg></div></div><div class="search-input-box"><input id="search-input" type="search" placeholder="è¯·è¾“å…¥å…³é”®è¯è¿›è¡Œç«™å†…æœç´¢â€¦â€¦" value="" maxlength="80"/></div><div class="search-result-container"><div class="search-result-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg></div></div></div></div></main><footer><div class="footer"><div id="footer-copyright">Â© 2025 <span>ğŸ’—</span> <a href="/null">Elara</a></div><div id="footer-info"><div id="footer-framework">ğŸš€æœ¬ç«™ç”± <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.1.0" target="_blank">Meow</a> å¼ºåŠ›é©±åŠ¨</div><div id="footer-runtime"><span id="runtime" data-startdate="2025-10-15T20:00:00.000Z">ğŸŒ»å·²ç¨³å®šè¿è¡Œ.å¹´.æœˆ.å¤©</span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: 'ğŸ±Share From Meow',
  onblur_title: 'æ»šå›æ¥ç»§ç»­å­¦ï¼ï½âœ§(Â´â–½`Êƒâ™¡Æª)',
  mouse_click: false,
  notify:{
    enable: false,
    info: 'å¤åˆ¶æˆåŠŸï½è½¬è½½è¯·æ ‡æ³¨æœ¬æ–‡åœ°å€',
    f12_info: 'å¼€å‘è€…æ¨¡å¼å·²æ‰“å¼€ï¼Œè¯·éµå¾ªæœ¬ç«™ç‰ˆæƒåè®®'
  },
  search: {
    enable: true,
    path: 'search.json',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/plugins/dist/search.js"></script>

<script src="/js/main.js" type="module"></script>
</div></body></html>